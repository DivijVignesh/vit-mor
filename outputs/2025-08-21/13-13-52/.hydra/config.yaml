name: imagenet_vit_mor_backbone
wandb: true
wandb_mode: online
wandb_entity: divijvignesh1223
wandb_project: vit-mor-backbone-experiments
wandb_run_name: vit-b16-backbone-mor
output_dir: vit_mor_backbone_imagenet
wandb_run_id: BackB001
model: vit_mor_backbone
backbone_name: google/vit-base-patch16-224
dataset: imagenet1k
image_size: 224
patch_size: 16
num_labels: 1000
tokenizer: null
use_backbone_pretrained: true
total_batch_size: 512
per_device_train_batch_size: 32
gradient_accumulation_steps: null
dataloader_num_workers: 2
precision: bf16
gradient_checkpointing: true
recursive:
  enable: true
  num_recursion: 3
  sharing: middle_cycle
  ln_share: true
  initialization: stepwise
mor:
  enable: true
  type: expert
  capacity: 0.7,0.2,0.1
  rand_router: false
  router_type: linear
  z_loss: false
  z_coeff: 1.0e-06
  temp: 1.0
  expert:
    cap_warmup_step: 1000
    router_func: sigmoid
    alpha: 0.1
    sampling: aux_loss
    include_first: true
    coeff: 0.001
    gating: weighted
num_train_steps: 25000
stop_steps: 25000
num_warmup_steps: 2500
learning_rate: 0.001
lr_scheduler_type: warmup_stable_decay
lr_scheduler_kwargs:
  num_decay_steps: 15000
  decay_type: cosine
adam_beta1: 0.9
adam_beta2: 0.999
weight_decay: 0.01
max_grad_norm: 1.0
save_steps: 2000
logging_steps: 50
save_total_limit: 3
resume_from_checkpoint: false
kv_sharing:
  enable: false
relaxation:
  enable: false
evaluation:
  enable: false
tensorboard: false
tensorboard_dir: null
