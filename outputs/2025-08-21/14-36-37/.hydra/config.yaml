name: imagenet_vit_mor_paper_aligned
wandb: true
wandb_mode: online
wandb_entity: divijvignesh1223
wandb_project: vit-mor-experiments
wandb_run_name: null
output_dir: vit_mor_imagenet
wandb_run_id: 1JBqef7i
model: vit_mor
dataset: imagenet1k-wds
hidden_size: 384
num_hidden_layers: 8
num_attention_heads: 6
intermediate_size: 1536
image_size: 224
patch_size: 16
num_labels: 1000
tensorboard: false
tensorboard_dir: null
tokenizer: null
model_name_or_path: vit-mor-Paper
model_config: null
attn_implementation: flash_attention_2
use_pretrained_weights: false
resume_from_checkpoint: false
resume_step: null
mor:
  enable: true
  type: expert
  capacity: 0.7,0.2,0.1
  rand_router: false
  router_type: linear
  z_loss: false
  z_coeff: 1.0e-06
  temp: 1.0
  expert:
    cap_warmup_step: 0
    router_func: sigmoid
    alpha: 0.1
    sampling: aux_loss
    include_first: true
    coeff: 0.001
    gating: weighted
recursive:
  enable: true
  num_recursion: 3
  sharing: middle_cycle
  ln_share: true
  initialization: stepwise
num_train_steps: 25000
stop_steps: 25000
num_warmup_steps: 2500
learning_rate: 0.001
lr_scheduler_type: warmup_stable_decay
lr_scheduler_kwargs:
  num_decay_steps: 15000
  decay_type: cosine
adam_beta1: 0.9
adam_beta2: 0.999
weight_decay: 0.05
max_grad_norm: 1.0
total_batch_size: 1024
per_device_train_batch_size: 64
gradient_accumulation_steps: null
precision: bf16
dataloader_num_workers: 8
gradient_checkpointing: true
kv_sharing:
  enable: false
relaxation:
  enable: false
evaluation:
  enable: false
logging_steps: 100
save_steps: 5000
save_total_limit: 3
